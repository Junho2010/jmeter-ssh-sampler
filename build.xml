<project name="jmeter-ssh-sampler" default="dist">
<description>Provides a sampler that returns the output of commands executed over an SSH tunnel.</description>

<property file="../user.properties" />

<property name="build.dir" value="bin" />

<property name="dist.dir" value="dist" />
<property name="dist.version" value="0.1.0" />
<property name="dist.name" value="${ant.project.name}-${dist.version}" />

<property name="src.dir" value="src" />
<property name="doc.dir" value="docs" />
<property name="javadoc.dir" value="${doc.dir}/javadoc" />

<property name="lib.dir" value="lib" />
<path id="libs">
	<fileset dir="${lib.dir}" includes="**/*.jar" />
</path>

<target name="_distdir">
    <mkdir dir="${dist.dir}" />
</target>
	
<target name="build" description="Compiles sources and copies property files into build directory">
	<mkdir dir="${build.dir}" />
	<javac srcdir="${src.dir}" destdir="${build.dir}" classpathref="libs" />
	<copy todir="${build.dir}">
		<fileset dir="${src.dir}">
			<include name="**/*.properties" />
		</fileset>
	</copy>
</target>

<target name="clean" description="Clear out files generated by the build process">
	<delete dir="${dist.dir}" />
	<delete dir="${build.dir}" />
	<delete dir="${javadoc.dir}" />
</target>

<target name="javadoc" depends="_distdir" description="Generate Javadocs from source">
	<mkdir dir="${javadoc.dir}" />
	<javadoc sourcepath="${src.dir}" classpathref="libs" destdir="${javadoc.dir}" />
	<zip destfile="${dist.dir}/${dist.name}-javadoc.zip" update="true" whenempty="fail">
		<zipfileset dir="${javadoc.dir}" prefix="${dist.name}-javadoc" />
	</zip>
</target>

<target name="jar" depends="build,_distdir" description="Create Jar file with compiled classes and property files">
	<jar basedir="${build.dir}" destfile="${dist.dir}/${dist.name}.jar" index="true" update="true" whenempty="fail" />
</target>

<target name="dist" depends="_distdir,jar,javadoc" description="Builds sampler jar and docs" />
</project>
